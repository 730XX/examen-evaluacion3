<p-dialog
  [(visible)]="visible"
  (onHide)="closeModal()"
  [modal]="true"
  [style]="{ width: '50rem' }"
  [breakpoints]="{ '1199px': '75vw', '575px': '90vw' }"
  [draggable]="false"
  [maximizable]="true"
  contentStyleClass="bg-[#1f242f] text-white p-6"
>
  <!-- Header personalizado -->
  <ng-template pTemplate="header">
    <div class="flex items-center gap-2 bg-[#1f242f] text-white">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-[#3c82f5]" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.354a4 4 0 110 5.292M15 21H3v-2a6 6 0 0112 0v2zm0 0h6v-2a6 6 0 00-9-5.656" />
      </svg>
      <span class="text-xl font-bold">{{ headerTitle }}</span>
    </div>
  </ng-template>

  <!-- Contenido del formulario -->
  <form [formGroup]="userForm" (ngSubmit)="onSave()">
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      
      <!-- Nombre de Usuario -->
      <div class="flex flex-col gap-2 md:col-span-1">
        <label for="userName" class="font-semibold text-gray-300">Nombre de Usuario</label>
        <input 
          pInputText 
          id="userName" 
          formControlName="name"
          placeholder="Ejm: Juan Pérez"
          class="w-full bg-[#111317] border border-gray-700 rounded-lg text-white p-3 placeholder-gray-500 focus:outline-none focus:border-[#3c82f5] transition-colors"
        />
      </div>

      <!-- Email -->
      <div class="flex flex-col gap-2 md:col-span-1">
        <label for="userEmail" class="font-semibold text-gray-300">Email</label>
        <input 
          pInputText 
          id="userEmail" 
          type="email"
          formControlName="email"
          placeholder="Ejm: usuario@ejemplo.com"
          class="w-full bg-[#111317] border border-gray-700 rounded-lg text-white p-3 placeholder-gray-500 focus:outline-none focus:border-[#3c82f5] transition-colors"
        />
      </div>

      <!-- Rol -->
      <div class="flex flex-col gap-2 md:col-span-1">
        <label for="userRole" class="font-semibold text-gray-300">Rol</label>
        <p-select 
          id="userRole"
          [options]="roles" 
          formControlName="role"
          placeholder="Seleccionar rol"
          [style]="{'width': '100%'}"
        ></p-select>
      </div>

      <!-- Contraseña (solo en creación) -->
      <div class="flex flex-col gap-2 md:col-span-1" *ngIf="mode === 'create'">
        <label for="userPassword" class="font-semibold text-gray-300">Contraseña</label>
        <input 
          pInputText 
          id="userPassword" 
          type="password"
          formControlName="password"
          placeholder="Ejm: ••••••••"
          class="w-full bg-[#111317] border border-gray-700 rounded-lg text-white p-3 placeholder-gray-500 focus:outline-none focus:border-[#3c82f5] transition-colors"
        />
      </div>

      <!-- Estado (solo en edición) -->
      <div class="flex flex-col gap-2 md:col-span-1" *ngIf="mode === 'edit'">
        <label for="userState" class="font-semibold text-gray-300">Estado</label>
        <p-select 
          id="userState"
          [options]="[{label: 'Activo', value: '1'}, {label: 'Inactivo', value: '0'}]" 
          formControlName="state"
          placeholder="Seleccionar estado"
          [style]="{'width': '100%'}"
        />
      </div>

    </div>
  </form>

  <!-- Footer -->
  <ng-template pTemplate="footer">
    <div class="w-full flex justify-end gap-3 bg-[#1f242f] pt-4">
      <button 
        pButton 
        label="Cancelar"
        (click)="closeModal()"
        class="p-button-text text-gray-300 hover:bg-gray-700"
      >
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
          <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd" />
        </svg>
      </button>
      <button 
        pButton 
        (click)="onSave()"
        [disabled]="userForm.invalid"
        class="bg-[#3c82f5] border-transparent text-white hover:bg-[#5a9aff] transition-colors"
      >
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
          <path d="M7.707 10.293a1 1 0 10-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 11.586V6h5a2 2 0 012 2v7a2 2 0 01-2 2H4a2 2 0 01-2-2V8a2 2 0 012-2h5v5.586l-1.293-1.293zM9 4a1 1 0 012 0v2H9V4z" />
        </svg>
        {{ mode === 'create' ? 'Crear Usuario' : 'Actualizar' }}
      </button>
    </div>
  </ng-template>
</p-dialog>
