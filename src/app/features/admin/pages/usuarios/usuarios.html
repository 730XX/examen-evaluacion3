<div class="w-full h-full flex flex-col bg-[#111317] text-white">
  
  <!-- HEADER -->
  <div class="flex items-center p-4 border-b border-gray-700 flex-none">
    <span class="text-2xl font-bold font-montserrat">Usuarios</span>
  </div>

  <!-- TOOLBAR -->
  <div class="flex items-center justify-between gap-4 p-4 border-b border-gray-700 flex-none">
    <!-- Buscador -->
    <input 
      type="text"
      placeholder="Buscar usuarios por nombre o email..."
      class="w-full md:w-1/3 px-4 py-2 bg-[#1f242f] border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-[#3c82f5] transition-colors"
    >

    <!-- Checkbox mostrar inactivos -->
    <label class="flex items-center gap-2 text-gray-300 cursor-pointer">
      <input 
        type="checkbox"
        [checked]="showInactive"
        (click)="showInactive = !showInactive; toggleShowInactive()"
        class="w-4 h-4 bg-[#1f242f] border border-gray-700 rounded focus:outline-none focus:border-[#3c82f5] transition-colors"
      >
      <span>Mostrar inactivos</span>
    </label>

    <!-- BotÃ³n crear usuario -->
    <button 
      (click)="showCreateUsuarioDialog()"
      class="flex-none px-4 py-2 bg-[#3c82f5] text-white text-sm font-medium rounded-lg hover:bg-[#5a9aff] transition-colors"
    >
      Crear Usuario
    </button>
  </div>

  <!-- CONTENIDO -->
  <div class="flex-1 p-4 overflow-y-auto">
    
    <!-- Indicador de carga -->
    <div *ngIf="loadingUsuarios" class="text-gray-400 text-sm animate-pulse mb-4">
      Cargando usuarios...
    </div>

    <!-- Mensaje si no hay usuarios -->
    <div *ngIf="!loadingUsuarios && usuariosFiltrados.length === 0" class="text-gray-500 text-sm mb-4">
      No hay usuarios registrados.
    </div>

    <!-- Tabla de usuarios -->
    <div *ngIf="!loadingUsuarios && usuariosFiltrados.length > 0" class="bg-[#1f242f] rounded-lg shadow-md overflow-hidden">
      <table class="w-full">
        <thead class="bg-[#151a23]">
          <tr>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider">
              Usuario
            </th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider">
              Email
            </th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider">
              Rol
            </th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider">
              Estado
            </th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider">
              Acciones
            </th>
          </tr>
        </thead>
        <tbody class="divide-y divide-gray-700">
          
          <tr *ngFor="let usuario of usuariosFiltrados" class="hover:bg-[#252b38] transition-colors">
            
            <!-- Nombre Usuario -->
            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-white">
              {{ usuario.user_name }}
            </td>

            <!-- Email -->
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-300">
              {{ usuario.user_email }}
            </td>

            <!-- Rol -->
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-300">
              <span class="px-3 py-1 rounded-full text-xs font-semibold"
                    [ngClass]="{
                      'bg-blue-900 text-blue-200': usuario.user_rol === '1' || usuario.user_rol === 1,
                      'bg-green-900 text-green-200': usuario.user_rol === '3' || usuario.user_rol === 3,
                      'bg-orange-900 text-orange-200': usuario.user_rol === '4' || usuario.user_rol === 4,
                      'bg-gray-700 text-gray-200': !usuario.user_rol
                    }">
                {{ getRoleName(usuario.user_rol) }}
              </span>
            </td>

            <!-- Estado -->
            <td class="px-6 py-4 whitespace-nowrap text-sm">
              <span class="px-3 py-1 rounded-full text-xs font-semibold"
                    [ngClass]="{
                      'bg-green-900 text-green-200': usuario.user_state === '1' || usuario.user_state === 1,
                      'bg-red-900 text-red-200': usuario.user_state !== '1' && usuario.user_state !== 1
                    }">
                {{ getStateLabel(usuario.user_state) }}
              </span>
            </td>

            <!-- Acciones -->
            <td class="px-6 py-4 whitespace-nowrap text-sm">
              <button 
                (click)="showEditUsuarioDialog(usuario)"
                class="text-[#3c82f5] hover:text-[#5a9aff] font-medium transition-colors">
                Editar
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

<!-- Modal para crear/editar usuario -->
<app-user-modal
  [(visible)]="modalVisible"
  [mode]="modalMode"
  [initialData]="dataToEdit"
  [roles]="rolesDisponibles"
  (save)="onModalSave($event)"
></app-user-modal>

<!-- Toast notifications -->
<p-toast [showTransitionOptions]="'250ms'" [showTransformOptions]="'translateX(100%)'" [hideTransitionOptions]="'150ms'" [hideTransformOptions]="'translateX(100%)'" />
